$(function(){function e(n){var t=1*(1*n.parent().prev().text().substring(1)*(1*n.parent().find(".num1").val())).toFixed(2);n.parent().next().next().html("￥"+t+".00"),o()}function a(){0==$(".next").size()&&($("#box3").css("display","none"),$("#box4").css("display","none"),$("#box5").css("display","none"),$("#box6").css("display","none"),$("#box7").css("display","none"),$(".box10").css("display","block"))}$("#trds").on("click",".check",function(){o()});var i=[];function o(){for(i=[],e=0;e<$(".che input").size();e++)$(".che input").eq(e).prop("checked")&&i.push(e);i.length==$(".che input").size()?$("#box6 input").prop("checked","checked"):$("#box6 input").removeAttr("checked");for(var n=0,t=0,e=0;e<i.length;e++)t+=1*$(".num1").eq(i[e]).val(),n+=1*$(".xiaoji").eq(i[e]).text().substring(1);$(".zong em").html(t),$(".enen em").html("￥"+n.toFixed(2))}$("#box6 input").on("click",function(){$(this).prop("checked")?$(".che input").prop("checked","checked"):$(".che input").removeAttr("checked"),o()}),$("#trds").on("change",".now1",function(){e($(this)),o()}),$(".box6_left").on("click",function(){location.href="index.html"});var c="../api/car.php",s="APItype=orderCar&time="+new Date;ajax("POST",c,s,function(n){console.log(n);var t=JSON.parse(n),e=getid("trds"),a=t.map(function(n){return"<tr data-id='"+n.good_id+'\'>\n                <th class="title-white">&nbsp</th>\n                <th class="che">\n                    <input type="checkbox" class="check">\n                </th>\n                <th class="kong">\n                    <img src="'+n.img1+'" alt="">\n                </th>\n                <th class="name">\n                    '+n.names+'\n                </th>\n                <th class="size">XXL</th>\n                <th class="money">￥'+n.price+'.00</th>\n                <th class="num">\n                    <div class="prev">-</div>\n                    <input type="text" value="'+n.num+'" class="num1">\n                    <div class="next">+</div>\n                </th>\n                <th class="youhui">-</th>\n                <th class="xiaoji">￥'+n.price*n.num+'.00</th>\n                <th class="con">\n                    <div class="del">删除</div>\n                </th>\n            </tr>'}).join("");e.innerHTML=a}),$("#trds").on("click",".next",function(){var n=$(this).prev().val();100<=++n&&(n=100);var t=$(this).parents("tr").attr("data-id");console.log(t),c="../api/car.php",s="APItype=orderCarNum&good_id="+t+"&num="+n+"&time="+new Date,ajax("POST",c,s,function(n){}),$(this).prev().val(n),e($(this))}),$("#trds").on("click",".prev",function(){var n=$(this).next().val();--n<=1&&(n=1);var t=$(this).parents("tr").attr("data-id");console.log(t),c="../api/car.php",s="APItype=orderCarNum&good_id="+t+"&num="+n+"&time="+new Date,ajax("POST",c,s,function(n){}),$(this).next().val(n),e($(this))}),$("#trds").on("click",".del",function(){$("#box9").remove(),$(this).parent().append('<div id="box9">\n        <p>确定删除此商品吗?</p>\n        <p>\n        <span class="block">确定</span>\n        <span class="none">取消</span>\n        </p>\n        <span class="bottom_san"></span>\n    </div>'),$("#trds").on("click",".block",function(){var n=$(this).parents("tr").attr("data-id");c="../api/car.php",s="APItype=orderCarDelete&good_id="+n+"&time="+new Date,ajax("POST",c,s,function(n){console.log(n)}),$(this).parent().parent().parent().parent().remove(),a(),o()}),$("#trds").on("click",".none",function(){$("#box9").remove()})}),$(".dels").on("click",function(){if(confirm("您真的不要我了吗"))for(var n=i.length-1;0<=n;n--){var t=$(this).parents("tr").attr("data-id");c="../api/car.php",s="APItype=orderCarDeleteAll&good_id="+t+"&time="+new Date,ajax("POST",c,s,function(n){console.log(n)}),$("#trds tr").eq(i[n]).remove(),a(),o()}})});